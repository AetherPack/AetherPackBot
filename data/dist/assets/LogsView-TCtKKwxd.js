import{a as C,o as N,C as I,j as o,k as e,z as y,p as L,t as a,n as _,v as A,D as B,l as D,m as E,F as U,s as V,r as u,c as F,e as n}from"./vendor-BrbMrNWY.js";import{e as G}from"./index-DOewkrcI.js";const O={class:"p-8 h-full flex flex-col"},T={class:"flex items-center justify-between mb-6"},j={class:"flex items-center gap-4"},M={class:"flex items-center gap-4 mb-4"},S={class:"text-sm text-gray-500"},z={key:0,class:"flex items-center justify-center flex-1"},W={key:1,class:"card"},H={class:"text-center py-8"},q={class:"text-red-500"},J={key:2,class:"flex-1 bg-gray-900 rounded-xl overflow-hidden font-mono text-sm"},K={class:"h-full overflow-y-auto p-4 scrollbar-thin"},P={key:0,class:"text-center py-8 text-gray-500"},Q={class:"text-gray-500 shrink-0"},X={class:"text-purple-400 shrink-0"},Y={class:"text-gray-300"},te=C({__name:"LogsView",setup(Z){const m=u([]),x=u(!0),c=u(""),r=u(!0),d=u(""),v=u("all");let i=null;async function f(){try{m.value=await G(500),c.value=""}catch{c.value="获取日志失败"}finally{x.value=!1}}const p=F(()=>{let s=m.value;if(v.value!=="all"&&(s=s.filter(t=>t.level===v.value)),d.value){const t=d.value.toLowerCase();s=s.filter(l=>l.message.toLowerCase().includes(t)||l.logger.toLowerCase().includes(t))}return s.slice(0,200)});function w(s){switch(s.toUpperCase()){case"DEBUG":return"text-gray-500";case"INFO":return"text-blue-500";case"WARNING":return"text-yellow-500";case"ERROR":return"text-red-500";case"CRITICAL":return"text-red-700 font-bold";default:return"text-gray-500"}}function k(s){try{return new Date(s).toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return s}}function g(){i&&clearInterval(i),i=window.setInterval(f,2e3)}function h(){i&&(clearInterval(i),i=null)}function b(){r.value=!r.value,r.value?g():h()}return N(()=>{f(),r.value&&g()}),I(()=>{h()}),(s,t)=>(n(),o("div",O,[e("div",T,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"系统日志"),e("p",{class:"text-gray-500 dark:text-gray-400 mt-1"},"实时查看系统运行日志")],-1)),e("div",j,[e("button",{onClick:b,class:y(["btn-ghost text-sm",r.value&&"text-green-600"])},[t[2]||(t[2]=e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),L(" "+a(r.value?"自动刷新中":"自动刷新"),1)],2),e("button",{onClick:f,class:"btn-secondary text-sm"},"刷新")])]),e("div",M,[_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>d.value=l),type:"text",class:"input max-w-sm",placeholder:"搜索日志..."},null,512),[[A,d.value]]),_(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>v.value=l),class:"input max-w-xs"},[...t[4]||(t[4]=[D('<option value="all">所有级别</option><option value="DEBUG">DEBUG</option><option value="INFO">INFO</option><option value="WARNING">WARNING</option><option value="ERROR">ERROR</option>',5)])],512),[[B,v.value]]),e("span",S,"共 "+a(p.value.length)+" 条",1)]),x.value?(n(),o("div",z,[...t[5]||(t[5]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):c.value?(n(),o("div",W,[e("div",H,[e("p",q,a(c.value),1),e("button",{onClick:f,class:"btn-primary mt-4"},"重试")])])):(n(),o("div",J,[e("div",K,[p.value.length===0?(n(),o("div",P," 暂无日志 ")):E("",!0),(n(!0),o(U,null,V(p.value,(l,R)=>(n(),o("div",{key:R,class:"flex items-start gap-3 py-1 hover:bg-gray-800/50"},[e("span",Q,a(k(l.timestamp)),1),e("span",{class:y(["shrink-0 w-16 text-right",w(l.level)])}," ["+a(l.level)+"] ",3),e("span",X,a(l.logger),1),e("span",Y,a(l.message),1)]))),128))])]))]))}});export{te as default};
